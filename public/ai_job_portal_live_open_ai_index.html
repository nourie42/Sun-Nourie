<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI-Powered Job Match Portal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family:'Inter',sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); }
    .glass { background:rgba(255,255,255,.9); backdrop-filter:blur(10px); }
    .card { border-radius:1rem; box-shadow:0 20px 40px rgba(0,0,0,.2); padding:1.5rem; }
    .score { position:absolute; top:1rem; right:1rem; width:4rem; height:4rem; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:800; color:#fff; }
    .excellent{background:linear-gradient(135deg,#00ff88,#00d084);} .good{background:linear-gradient(135deg,#3b82f6,#2563eb);} .fair{background:linear-gradient(135deg,#fbbf24,#f59e0b);} .poor{background:linear-gradient(135deg,#f87171,#ef4444);}
    .spinner{width:40px;height:40px;border:4px solid #e5e7eb;border-top-color:#667eea;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body class="min-h-screen p-6">
  <div class="max-w-[1200px] mx-auto space-y-6">
    <header class="text-center text-white">
      <h1 class="text-3xl font-bold">ðŸ¤– AI-Powered Job Match Portal</h1>
      <p class="opacity-90">Real AI analysis of job descriptions against your profile</p>
      <div class="mt-2 inline-flex items-center gap-2 bg-emerald-500 text-white px-3 py-1 rounded-full text-xs font-semibold">Live AI Enabled</div>
    </header>

    <!-- Search Section -->
    <section class="glass card">
      <button id="btnSearch" class="px-5 py-3 rounded-xl bg-indigo-600 text-white font-semibold hover:brightness-110">Search & Analyze with AI</button>
      <div id="busy" class="hidden mt-2 items-center gap-2"><div class="spinner"></div><span>Workingâ€¦</span></div>
      <p id="err" class="mt-3 hidden text-sm text-red-600"></p>
    </section>

    <!-- Results Section -->
    <section id="results" class="glass card hidden">
      <div class="flex items-center justify-between mb-4">
        <div id="resultCount" class="font-semibold">0 jobs found</div>
        <div class="flex gap-2">
          <button class="px-3 py-2 rounded-lg border" data-sort="match">Best Match</button>
          <button class="px-3 py-2 rounded-lg border" data-sort="recent">Most Recent</button>
          <button class="px-3 py-2 rounded-lg border" data-sort="salary">Highest Salary</button>
        </div>
      </div>
      <div id="grid" class="grid gap-4"></div>
    </section>
  </div>

  <script>
    // Hard-coded API key
    const API_KEY = "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";

    // Sample job listings
    const SAMPLE = [
      {title:'Preschool Director',company:'Bright Horizons Early Learning',salary:'$48,000 - $68,000',category:'preschool-director',req:["Bachelor's in ECE", '5+ yrs leadership', 'NC Director Credential preferred', 'Strong communication'],desc:'Lead center ops, staff, compliance, quality standards.',postedDays: r(1,14),url:'https://www.indeed.com/q-preschool-director-jobs.html'},
      {title:'Assistant Director - Early Learning Center',company:'KinderCare Education',salary:'$42,000 - $58,000',category:'assistant-director',req:['Associate min, BA preferred', '3+ yrs childcare', 'Staff supervision', 'Licensing knowledge'],desc:'Assist director, supervise teachers, manage enrollment and families.',postedDays: r(1,14),url:'https://www.indeed.com/q-assistant-director-jobs.html'},
      {title:'Education Program Administrator',company:'Wake County Public Schools',salary:'$52,000 - $72,000',category:'education-administrator',req:['Masters in Education', '7+ yrs leadership', 'Budget experience', 'Regulations knowledge'],desc:'Oversee programs, budgets, outcomes, compliance.',postedDays: r(1,14),url:'https://www.linkedin.com/jobs'},
      {title:'Childcare Center Director',company:'Primrose Schools',salary:'$45,000 - $65,000',category:'preschool-director',req:['Bachelor required', '5+ yrs childcare mgmt', 'Business acumen', 'Parent comms'],desc:'Direct operations, staff development, parent relations.',postedDays: r(1,14),url:'https://www.glassdoor.com/Job'},
      {title:'Curriculum Development Specialist',company:'Durham Public Schools',salary:'$50,000 - $70,000',category:'curriculum-coordinator',req:['Masters in C&I', 'Teaching exp', 'Standards knowledge', 'PD experience'],desc:'Design curriculum, train teachers, align to standards.',postedDays: r(1,14),url:'https://www.ziprecruiter.com'},
      {title:'Early Childhood Education Coordinator',company:'YMCA of the Triangle',salary:'$40,000 - $56,000',category:'program-manager',req:['BA in ECE', '3+ yrs coordination', 'Org skills', 'Community partnerships'],desc:'Coordinate programs, partners, scheduling, impact.',postedDays: r(1,14),url:'https://careercenter.naeyc.org'}
    ];

    function r(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

    // Button click handler
    document.getElementById('btnSearch').addEventListener('click', async()=>{
      hideErr();
      const btn=document.getElementById('btnSearch');
      const busy=document.getElementById('busy');
      btn.disabled=true;busy.classList.remove('hidden');
      try{
        const analyzed=[];
        for(const job of SAMPLE){
          const analysis=await aiAnalyzeJob(job);
          analyzed.push({...job,analysis});
        }
        renderResults(analyzed);
      }catch(e){showErr('Failed to fetch from OpenAI');console.error(e);}finally{btn.disabled=false;busy.classList.add('hidden');}
    });

    async function aiAnalyzeJob(job){
      const sys="You are a career coach. Return JSON with score, strengths, gaps, insight, recommendation.";
      const user=`Job: ${job.title} at ${job.company}, Salary: ${job.salary}`;
      const res=await fetch('https://api.openai.com/v1/chat/completions',{
        method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${API_KEY}`},
        body:JSON.stringify({model:'gpt-4o-mini',messages:[{role:'system',content:sys},{role:'user',content:user}],response_format:{type:'json_object'}})
      });
      if(!res.ok)throw new Error(await res.text());
      const data=await res.json();
      return JSON.parse(data.choices[0].message.content);
    }

    // Render results
    function renderResults(items){
      const results=document.getElementById('results');
      const grid=document.getElementById('grid');
      const count=document.getElementById('resultCount');
      results.classList.remove('hidden');
      grid.innerHTML='';
      count.textContent=`${items.length} job(s) found`;
      items.forEach(job=>{
        const el=document.createElement('div');
        el.className='relative glass card';
        const cls=scoreClass(job.analysis.score);
        el.innerHTML=`<div class="score ${cls}">${job.analysis.score||'--'}%</div>
          <h3 class="text-lg font-semibold">${job.title}</h3>
          <p>${job.company} â€” ${job.salary}</p>
          <p class="mt-2 text-sm">${job.analysis.insight||''}</p>
          <ul class="list-disc ml-5 text-sm"><b>Strengths:</b> ${(job.analysis.strengths||[]).map(s=>`<li>${s}</li>`).join('')}</ul>
          <ul class="list-disc ml-5 text-sm"><b>Gaps:</b> ${(job.analysis.gaps||[]).map(s=>`<li>${s}</li>`).join('')}</ul>
          <p class="mt-2 italic text-sm">${job.analysis.recommendation||''}</p>
          <a href="${job.url}" target="_blank" class="inline-block mt-3 px-4 py-2 rounded-lg bg-indigo-600 text-white">Apply Now â†’</a>`;
        grid.appendChild(el);
      });

      document.querySelectorAll('[data-sort]').forEach(btn=>btn.onclick=()=>sortGrid(btn.dataset.sort));
    }

    function scoreClass(s){if(s>=90)return 'excellent';if(s>=80)return 'good';if(s>=70)return 'fair';return 'poor';}

    function sortGrid(by){
      const grid=document.getElementById('grid');
      const cards=[...grid.children];
      cards.sort((a,b)=>{
        if(by==='match')return (+b.querySelector('.score').textContent.replace('%',''))-(+a.querySelector('.score').textContent.replace('%',''));
        if(by==='recent')return 0; // Placeholder
        if(by==='salary')return 0; // Placeholder
      });
      grid.innerHTML='';cards.forEach(c=>grid.appendChild(c));
    }

    function showErr(msg){const e=document.getElementById('err');e.textContent=msg;e.classList.remove('hidden');}
    function hideErr(){document.getElementById('err').classList.add('hidden');}
  </script>
</body>
</html>
