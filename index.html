<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Gas Station Gallons Estimator (GPT)</title>
<style>
  :root{--bg:#0b0c10;--card:#141821;--text:#e8e8e8;--muted:#97a3b6;--accent:#3a82f7;--border:#2a2f3a}
  body{margin:0;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--text)}
  .wrap{max-width:900px;margin:0 auto;padding:16px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;margin:12px 0}
  h1{margin:0 0 8px}
  label{display:block;font-weight:600;margin:10px 0 4px}
  input,button{font:inherit}
  input[type="text"],input[type="number"]{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#1b2130;color:#e8e8e8}
  button{padding:10px 14px;border-radius:10px;border:0;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
  .muted{color:var(--muted);font-size:12px}
  .result{white-space:pre-wrap;line-height:1.55}
  .facts{font-size:12px;background:#101520;border:1px solid #233047;border-radius:8px;padding:8px;overflow:auto;max-height:200px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card"><h1>Gas Station Gallons Estimator (GPT)</h1>
    <div class="muted">Enter the address and regular MPDs. The model will pull traffic, competition, and planned sites, then estimate monthly gallons with a short numeric rationale.</div>
  </div>

  <div class="card">
    <label>Prospect address</label>
    <input id="addr" type="text" placeholder="e.g., 4173 Knightdale Blvd, Knightdale NC">
    <div style="display:flex;gap:8px;margin-top:8px">
      <div style="flex:1"><label>Regular MPDs</label><input id="mpd" type="number" value="6" min="0"></div>
      <div style="flex:1"><label>Diesel positions (optional)</label><input id="diesel" type="number" value="0" min="0"></div>
    </div>
    <button id="go" style="margin-top:10px">Estimate Gallons</button>
    <div id="status" class="muted"></div>
  </div>

  <div class="card">
    <b>GPT Estimate</b>
    <div id="result" class="result muted">Results will appear here.</div>
  </div>

  <details class="card">
    <summary><b>Data used (debug)</b></summary>
    <div id="facts" class="facts">// waiting…</div>
  </details>
</div>

<script>
const API_BASE = "https://YOUR-BACKEND.onrender.com"; // <-- set to your Web Service URL
document.getElementById('go').addEventListener('click', run);

async function run(){
  const status = document.getElementById('status');
  const result = document.getElementById('result');
  const factsBox = document.getElementById('facts');
  result.textContent = ""; factsBox.textContent = "// waiting…";
  status.textContent = "Thinking…";

  const address = document.getElementById('addr').value.trim();
  const mpds = Number(document.getElementById('mpd').value || 0);
  const diesel = Number(document.getElementById('diesel').value || 0);
  if (!address || !Number.isFinite(mpds)) { status.textContent = "Enter a valid address and MPDs"; return; }

  try{
    const r = await fetch(API_BASE + "/estimate", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ address, mpds, diesel })
    });
    const j = await r.json();
    if (!j.ok) { result.textContent = "Error: " + (j.error || r.status); status.textContent=""; return; }
    result.textContent = j.text || "[No text returned]";
    factsBox.textContent = JSON.stringify(j.facts, null, 2);
    status.textContent = "Done.";
  }catch(e){
    result.textContent = "Network error: " + String(e);
    status.textContent = "";
  }
}
</script>
</body>
</html>
